<!-- Stub template for synchronization gauge panel -->
<div class="card">
  <h3>Synchronization Metrics</h3>
  <canvas id="gauge_synchronization"></canvas>
</div>

<script>
async function fetch_synchronization_metrics() {
  try {
    const res = await fetch("/metrics/synchronization", { cache: "no-store" });
    if (!res.ok) throw new Error("HTTP " + res.status);
    const data = await res.json();
    // wired by codex: update Chart.js gauge with `data.metrics.value`
  } catch (e) {
    console.error("Failed to fetch synchronization metrics:", e);
  }
}

const ctx_synchronization = document.getElementById('gauge_synchronization').getContext('2d');
const gauge_synchronization = new Chart(ctx_synchronization, {
  type: 'doughnut',
  data: {
    labels: ['Value', 'Remainder'],
    datasets: [{
      data: [0, 100],
    }]
  },
  options: {
    responsive: true,
    cutout: '80%',
    plugins: {
      legend: { display: false }
    }
  }
});

setInterval(fetch_synchronization_metrics, 5000);
fetch_synchronization_metrics();
</script>

<script>
/* Auto-injected by codex_sequential_executor.py */
function updateGauges(data) {
  try {
    const v = (data && data.metrics && typeof data.metrics.value === 'number')
      ? data.metrics.value : 0;
    // Example: assume a global Chart.js instance window.codexGauge
    if (window.codexGauge && window.codexGauge.data && window.codexGauge.update) {
      const ds = window.codexGauge.data.datasets?.[0];
      if (ds) {
        ds.data = [v, Math.max(0, 100 - v)];
      }
      if (window.codexGauge.options && window.codexGauge.options.plugins && window.codexGauge.options.plugins.tooltip) {
        window.codexGauge.options.plugins.tooltip.enabled = true;
      }
      window.codexGauge.update();
    }
  } catch (e) {
    console.error("Gauge update error:", e);
  }
}
</script>
