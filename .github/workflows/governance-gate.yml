name: Governance Gate

on:
  push:
  pull_request:

jobs:
  policy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          lfs: true
          fetch-depth: 0
      - run: git lfs checkout
      - uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - run: pip install -r requirements-test.txt
      - name: Run policy tests
        run: pytest policy_tests --junitxml=policy_tests.xml
      - name: Annotate results
        if: always()
        uses: dorny/test-reporter@v1
        with:
          name: Policy Tests
          path: policy_tests.xml
          reporter: junit
